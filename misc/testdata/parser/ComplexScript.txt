FILE
  PsiComment(COMMENT)('# ### setup:')
  PsiElement(DUMMY_BLOCK)
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# install.packages(c("ggplot2", "HMM", "zoo", "reshape", "plyr", "foreach", "Kendall", "XML", "stringr"))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# install.packages('snippets',,'http://www.rforge.net/')')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# source("http://bioconductor.org/biocLite.R")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# biocLite("Biostrings")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# biocLite("VennDiagram")')
          PsiElement(EOL)('\n\n\n')
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('snippets')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('HMM')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('zoo')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('reshape')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('plyr')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('VennDiagram')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('Biostrings')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('Kendall')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('stringr')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('ggplot2')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('readFastaIntoDF')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('fileName')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('## read a fasta file as data.fram')
                        PsiElement(EOL)('\n\n')
                        R_EXPR
                          PsiElement(SYMBOL)('fastaData')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('read.BStringSet')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('fileName')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(STR_CONST)('"fasta"')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('fastaDataDF')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('as.data.frame')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('as.character')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('fastaData')
                                  PsiElement())(')')
                              PsiElement(,)(',')
                              R_SUB
                                PsiElement(SYMBOL)('stringsAsFactors')
                                PsiElement(=)('=')
                                R_EXPR
                                  PsiElement(SYMBOL)('FALSE')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('fastaDataDF')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('transform')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('fastaDataDF')
                              PsiElement(,)(',')
                              R_SUB
                                PsiElement(SYMBOL)('GeneDesc')
                                PsiElement(=)('=')
                                R_EXPR
                                  PsiElement(SYMBOL)('rownames')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('fastaDataDF')
                                  PsiElement())(')')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('rownames')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('fastaDataDF')
                          PsiElement())(')')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(NULL_CONST)('NULL')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('names')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('fastaDataDF')
                          PsiElement())(')')
                          PsiElement([)('[')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(NUM_CONST)('1')
                          PsiElement(])(']')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(STR_CONST)('"Sequence"')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('return')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('fastaDataDF')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# DEBUG asSequences<- dict_disc_proteome$Sequence')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('# DEBUG asSequences<- subset(dict_disc_proteome, str_detect(GeneDesc, "0001590"))$Sequence')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('calcASFreqDist')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('asSequences')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('useSeqLetters')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(SYMBOL)('FALSE')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('## calclate the relative AS frequency distribution')
                        PsiElement(EOL)('\n\n')
                        R_EXPR
                          PsiElement(SYMBOL)('sequenceSeq')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('BStringSet')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('asSequences')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(IF)('if')
                          R_IFCOND
                            PsiElement(()('(')
                            R_EXPR
                              PsiElement(SYMBOL)('useSeqLetters')
                            PsiElement())(')')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement({)('{')
                              R_EXPRLIST
                                R_EXPR_OR_ASSIGN
                                  PsiElement(EOL)('\n')
                                  R_EXPR
                                    PsiElement(SYMBOL)('foundAS')
                                    PsiElement(<-)('<-')
                                    R_EXPR
                                      PsiElement(SYMBOL)('uniqueLetters')
                                      PsiElement(()('(')
                                      R_SUBLIST
                                        R_SUB
                                          R_EXPR
                                            PsiElement(SYMBOL)('sequenceSeq')
                                      PsiElement())(')')
                                PsiElement(;)(';')
                                PsiElement(EOL)('\n')
                              PsiElement(})('}')
                          PsiElement(ELSE)('else')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement({)('{')
                              R_EXPRLIST
                                R_EXPR_OR_ASSIGN
                                  PsiElement(EOL)('\n')
                                  R_EXPR
                                    PsiElement(SYMBOL)('foundAS')
                                    PsiElement(<-)('<-')
                                    R_EXPR
                                      PsiElement(SYMBOL)('c')
                                      PsiElement(()('(')
                                      R_SUBLIST
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"A"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"C"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"D"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"E"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"F"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"G"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"H"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"I"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"K"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"L"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"M"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"N"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"P"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"Q"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"R"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"S"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"T"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"V"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"W"')
                                        PsiElement(,)(',')
                                        R_SUB
                                          R_EXPR
                                            PsiElement(STR_CONST)('"Y"')
                                      PsiElement())(')')
                                PsiElement(EOL)('\n')
                              PsiElement(})('}')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('letFreqs')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('letterFrequency')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('sequenceSeq')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('foundAS')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('letFreqs')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('letFreqs')
                            PsiElement(+)('+')
                            R_EXPR
                              PsiElement(NUM_CONST)('1')
                      PsiComment(COMMENT)('## add 1 offset as Ian did')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('relativeLetFreqs')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('letFreqs')
                            PsiElement(/)('/')
                            R_EXPR
                              PsiElement(SYMBOL)('rowSums')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('letFreqs')
                              PsiElement())(')')
                      PsiComment(COMMENT)('## calcuate relative frequencies')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('asFreqDist')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('colSums')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(NUM_CONST)('100')
                                  PsiElement(*)('*')
                                  R_EXPR
                                    PsiElement(SYMBOL)('relativeLetFreqs')
                            PsiElement())(')')
                            PsiElement(/)('/')
                            R_EXPR
                              PsiElement(SYMBOL)('nrow')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('relativeLetFreqs')
                              PsiElement())(')')
                      PsiComment(COMMENT)('## do the normalization')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('return')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('data.frame')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    PsiElement(SYMBOL)('amacid')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('names')
                                      PsiElement(()('(')
                                      R_SUBLIST
                                        R_SUB
                                          R_EXPR
                                            PsiElement(SYMBOL)('asFreqDist')
                                      PsiElement())(')')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('frequency')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('asFreqDist')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('row.names')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(NULL_CONST)('NULL')
                                PsiElement())(')')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('runHMM')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('Sequence')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('hmm')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('...')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('# print(GeneDesc)')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('t1')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('unlist')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('strsplit')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('Sequence')
                                    PsiElement(,)(',')
                                    R_SUB
                                      PsiElement(SYMBOL)('split')
                                      PsiElement(=)('=')
                                      R_EXPR
                                        PsiElement(STR_CONST)('""')
                                  PsiElement())(')')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      PsiComment(COMMENT)('# browser()')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('## do the viterbi alignment')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('o1')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('viterbi')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('hmm')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('t1')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('output')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('paste')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('o1')
                              PsiElement(,)(',')
                              R_SUB
                                PsiElement(SYMBOL)('collapse')
                                PsiElement(=)('=')
                                R_EXPR
                                  PsiElement(STR_CONST)('""')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('## calculate the score')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('o2')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('posterior')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('hmm')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('t1')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('dfo2')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('melt')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('o2')
                            PsiElement())(')')
                      PsiComment(COMMENT)('#convert matrix to data frame')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('o2p')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('subset')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('dfo2')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('states')
                                  PsiElement(==)('==')
                                  R_EXPR
                                    PsiElement(STR_CONST)('"P"')
                            PsiElement())(')')
                            PsiElement($)('$')
                            PsiElement(SYMBOL)('value')
                      PsiComment(COMMENT)('#Split to get just Prion probabilities')
                      PsiElement(EOL)('\n')
                      PsiComment(COMMENT)('# o2b <- subset(dfo2, states=="B")$value    #Split to get just Prion probabilities')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('# browser()')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('ggplot')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('dfo2')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('aes')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('index')
                                  PsiElement(,)(',')
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('value')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('color')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('states')
                                PsiElement())(')')
                          PsiElement())(')')
                          PsiElement(+)('+')
                          R_EXPR
                            PsiElement(SYMBOL)('geom_line')
                            PsiElement(()('(')
                            R_SUBLIST
                              <empty list>
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EQUAL_ASSIGN
                          R_EXPR
                            PsiElement(SYMBOL)('coreScore')
                          PsiElement(=)('=')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement(SYMBOL)('as.numeric')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('NA')
                              PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(IF)('if')
                          R_IFCOND
                            PsiElement(()('(')
                            R_EXPR
                              PsiElement(SYMBOL)('nchar')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('Sequence')
                              PsiElement())(')')
                              PsiElement(>=)('>=')
                              R_EXPR
                                PsiElement(NUM_CONST)('60')
                            PsiElement())(')')
                          R_EXPR_OR_ASSIGN
                            R_EQUAL_ASSIGN
                              R_EXPR
                                PsiElement(SYMBOL)('coreScore')
                              PsiElement(=)('=')
                              R_EXPR_OR_ASSIGN
                                R_EXPR
                                  PsiElement(SYMBOL)('max')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('rollmean')
                                        PsiElement(()('(')
                                        R_SUBLIST
                                          R_SUB
                                            R_EXPR
                                              PsiElement(SYMBOL)('o2p')
                                          PsiElement(,)(',')
                                          R_SUB
                                            R_EXPR
                                              PsiElement(NUM_CONST)('60')
                                        PsiElement())(')')
                                  PsiElement())(')')
                      PsiComment(COMMENT)('#calculate maximum mean of posterior prion probabilities for a sliding window of 60')
                      PsiElement(EOL)('\n')
                      PsiComment(COMMENT)('# if(nchar(Sequence)>=60) coreScore = max(rollmean(o2p,60)/rollmean(o2b,60))  #Paper method: calculate max ratio of the moving average mean in both  states')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('return')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('c')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    PsiElement(SYMBOL)('Segmentation')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('output')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('maxRollPScore')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('coreScore')
                                PsiElement())(')')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# calcScore <- function(GeneDesc, Sequence, hmm, ...){')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \tt1 <- unlist(strsplit(Sequence, split=""))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \to2<-posterior(hmm, t1)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \tdfo2 <- melt(o2)                            #convert matrix to data frame')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \to2p <- subset(dfo2, states=="P")$value    #Split to get just Prion probabilities')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \t# \tggplot(dfo2, aes(index, value, color=states)) + geom_line()')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \tcoreScore=0')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \tif(nchar(Sequence)>=60) coreScore = max(rollmean(o2p,60))  #calculate maximum mean of posterior prion probabilities for a sliding window of 60')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \treturn(c(maxRollPScore=coreScore))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# }')
          PsiElement(EOL)('\n\n\n')
          R_EXPR
            PsiElement(SYMBOL)('createPyTable')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('cmd')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('...')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('## runs a python script that prints a result table to stout. This table then is parsed back into a data.frame')
                        PsiElement(EOL)('\n')
                        PsiElement(EOL)('\n')
                        R_EQUAL_ASSIGN
                          R_EXPR
                            PsiElement(SYMBOL)('tFile')
                          PsiElement(=)('=')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement(SYMBOL)('tempfile')
                              PsiElement(()('(')
                              R_SUBLIST
                                <empty list>
                              PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('system')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('paste')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(STR_CONST)('"source ~/.bash_profile; python "')
                                  PsiElement(,)(',')
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('cmd')
                                  PsiElement(,)(',')
                                  R_SUB
                                    R_EXPR
                                      PsiElement(STR_CONST)('" > "')
                                  PsiElement(,)(',')
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('tFile')
                                PsiElement())(')')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                      PsiComment(COMMENT)('# browser()')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('result')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('read.table')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('tFile')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('...')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('unlink')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('tFile')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('return')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('result')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.fasta')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('seq_names')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('sequences')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('file')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('fastaData')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('AAStringSet')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('sequences')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('names')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('fastaData')
                          PsiElement())(')')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('seq_names')
                      PsiElement(;)(';')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('write.XStringSet')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('fastaData')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('file')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(SYMBOL)('file')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('format')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(STR_CONST)('"fasta"')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('width')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(NUM_CONST)('80')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('extractDomainSegs')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('viterbi_paths')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('## extracts all the prion segments with at least 60 consecutive Psviterbi_paths')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('domain_segments')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('str_locate_all')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('viterbi_paths')
                                  PsiElement($)('$')
                                  PsiElement(SYMBOL)('Segmentation')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(STR_CONST)('"P{60,}"')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('rownames')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('viterbi_paths')
                          PsiElement())(')')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(NUM_CONST)('1')
                            PsiElement(:)(':')
                            R_EXPR
                              PsiElement(SYMBOL)('nrow')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('viterbi_paths')
                              PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('names')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('domain_segments')
                          PsiElement())(')')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(NUM_CONST)('1')
                            PsiElement(:)(':')
                            R_EXPR
                              PsiElement(SYMBOL)('length')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('domain_segments')
                              PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('domain_segments')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('ldply')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('domain_segments')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('as.data.frame')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('subset')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('merge')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('viterbi_paths')
                                  PsiElement(,)(',')
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('domain_segments')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('by.x')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(NUM_CONST)('0')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('by.y')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(STR_CONST)('".id"')
                                  PsiElement(,)(',')
                                  R_SUB
                                    PsiElement(SYMBOL)('all.x')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('TRUE')
                                PsiElement())(')')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('select')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(-)('-')
                                R_EXPR
                                  PsiElement(SYMBOL)('Row.names')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('xout_pdomains')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('df_with_segs_and_seq')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('adply')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('df_with_segs_and_seq')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(NUM_CONST)('1')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('splat')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      R_FUNDEF
                                        PsiElement(FUNCTION)('function')
                                        PsiElement(()('(')
                                        R_FORMLIST
                                          R_FORM
                                            PsiElement(SYMBOL)('Sequence')
                                          PsiElement(,)(',')
                                          R_FORM
                                            PsiElement(SYMBOL)('Segmentation')
                                          PsiElement(,)(',')
                                          R_FORM
                                            PsiElement(SYMBOL)('...')
                                        PsiElement())(')')
                                        R_EXPR_OR_ASSIGN
                                          R_EXPR
                                            PsiElement({)('{')
                                            R_EXPRLIST
                                              R_EXPR_OR_ASSIGN
                                                PsiElement(EOL)('\n')
                                                PsiComment(COMMENT)('# browser()')
                                                PsiElement(EOL)('\n')
                                                R_EXPR
                                                  PsiElement(SYMBOL)('split_sequence')
                                                  PsiElement(<-)('<-')
                                                  R_EXPR
                                                    PsiElement(SYMBOL)('unlist')
                                                    PsiElement(()('(')
                                                    R_SUBLIST
                                                      R_SUB
                                                        R_EXPR
                                                          PsiElement(SYMBOL)('strsplit')
                                                          PsiElement(()('(')
                                                          R_SUBLIST
                                                            R_SUB
                                                              R_EXPR
                                                                PsiElement(SYMBOL)('Sequence')
                                                            PsiElement(,)(',')
                                                            R_SUB
                                                              PsiElement(SYMBOL)('split')
                                                              PsiElement(=)('=')
                                                              R_EXPR
                                                                PsiElement(STR_CONST)('""')
                                                          PsiElement())(')')
                                                    PsiElement())(')')
                                              PsiElement(EOL)('\n')
                                              R_EXPR_OR_ASSIGN
                                                R_EXPR
                                                  PsiElement(SYMBOL)('split_align')
                                                  PsiElement(<-)('<-')
                                                  R_EXPR
                                                    PsiElement(SYMBOL)('unlist')
                                                    PsiElement(()('(')
                                                    R_SUBLIST
                                                      R_SUB
                                                        R_EXPR
                                                          PsiElement(SYMBOL)('strsplit')
                                                          PsiElement(()('(')
                                                          R_SUBLIST
                                                            R_SUB
                                                              R_EXPR
                                                                PsiElement(SYMBOL)('Segmentation')
                                                            PsiElement(,)(',')
                                                            R_SUB
                                                              PsiElement(SYMBOL)('split')
                                                              PsiElement(=)('=')
                                                              R_EXPR
                                                                PsiElement(STR_CONST)('""')
                                                          PsiElement())(')')
                                                    PsiElement())(')')
                                              PsiElement(EOL)('\n')
                                              R_EXPR_OR_ASSIGN
                                                PsiElement(EOL)('\n')
                                                R_EQUAL_ASSIGN
                                                  R_EXPR
                                                    PsiElement(SYMBOL)('split_sequence')
                                                    PsiElement([)('[')
                                                    R_SUBLIST
                                                      R_SUB
                                                        R_EXPR
                                                          PsiElement(SYMBOL)('which')
                                                          PsiElement(()('(')
                                                          R_SUBLIST
                                                            R_SUB
                                                              R_EXPR
                                                                PsiElement(SYMBOL)('split_align')
                                                                PsiElement(==)('==')
                                                                R_EXPR
                                                                  PsiElement(STR_CONST)('"P"')
                                                          PsiElement())(')')
                                                    PsiElement(])(']')
                                                  PsiElement(=)('=')
                                                  R_EXPR_OR_ASSIGN
                                                    R_EXPR
                                                      PsiElement(STR_CONST)('"X"')
                                              PsiElement(EOL)('\n')
                                              R_EXPR_OR_ASSIGN
                                                PsiElement(EOL)('\n')
                                                R_EXPR
                                                  PsiElement(SYMBOL)('return')
                                                  PsiElement(()('(')
                                                  R_SUBLIST
                                                    R_SUB
                                                      R_EXPR
                                                        PsiElement(SYMBOL)('c')
                                                        PsiElement(()('(')
                                                        R_SUBLIST
                                                          R_SUB
                                                            PsiElement(SYMBOL)('prion_xout_sequence')
                                                            PsiElement(=)('=')
                                                            R_EXPR
                                                              PsiElement(SYMBOL)('paste')
                                                              PsiElement(()('(')
                                                              R_SUBLIST
                                                                R_SUB
                                                                  R_EXPR
                                                                    PsiElement(SYMBOL)('split_sequence')
                                                                PsiElement(,)(',')
                                                                R_SUB
                                                                  PsiElement(SYMBOL)('collapse')
                                                                  PsiElement(=)('=')
                                                                  R_EXPR
                                                                    PsiElement(STR_CONST)('""')
                                                              PsiElement())(')')
                                                        PsiElement())(')')
                                                  PsiElement())(')')
                                              PsiElement(EOL)('\n')
                                            PsiElement(})('}')
                                PsiElement())(')')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('.progress')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(STR_CONST)('"text"')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# ## use this to enable multiple cores for ddply')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# library(plyr)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# library(foreach)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# library(doMC)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# registerDoMC(cores=8)')
          PsiElement(EOL)('\n\n\n')
          R_EQUAL_ASSIGN
            R_EXPR
              PsiElement(SYMBOL)('prion_model')
            PsiElement(=)('=')
            R_EXPR_OR_ASSIGN
              R_EXPR
                PsiElement(SYMBOL)('data.frame')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('amacid')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(SYMBOL)('c')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"A"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"C"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"D"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"E"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"F"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"G"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"H"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"I"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"K"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"L"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"M"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"N"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"P"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"Q"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"R"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"S"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"T"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"V"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"W"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"Y"')
                      PsiElement())(')')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(EOL)('\n')
                    PsiElement(SYMBOL)('prion_frequency')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(SYMBOL)('c')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('4.2501322')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('0.8495353')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('2.0713379')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('1.7073955')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('3.3644566')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('10.8440664')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('1.0713270')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('1.5822792')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('2.7584645')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('3.4096907')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('2.0704712')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('19.3603931')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('3.5267232')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('16.2506059')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('2.3562638')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('10.5433046')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('3.2207167')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('2.1705145')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('0.8495353')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(NUM_CONST)('7.7427865')
                      PsiElement())(')')
                PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## J O U  encoding AS which could be sequenced properly')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EQUAL_ASSIGN
            R_EXPR
              PsiElement(SYMBOL)('dict_specific_amacids')
            PsiElement(=)('=')
            R_EXPR_OR_ASSIGN
              R_EXPR
                PsiElement(SYMBOL)('data.frame')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('amacid')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(SYMBOL)('c')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"X"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"*"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"J"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"O"')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"U"')
                      PsiElement())(')')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('prion_frequency')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('0.000001')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('frequency')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('0.000001')
                PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('createPrionHMM')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('state_model')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('States')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('c')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(STR_CONST)('"P"')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(STR_CONST)('"B"')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('StartProbs')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('c')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(NUM_CONST)('0.05')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(NUM_CONST)('0.95')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('TransProbs')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('matrix')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('c')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(NUM_CONST)('0.98')
                                    PsiElement(,)(',')
                                    R_SUB
                                      R_EXPR
                                        PsiElement(NUM_CONST)('0.02')
                                    PsiElement(,)(',')
                                    R_SUB
                                      R_EXPR
                                        PsiElement(NUM_CONST)('0.001')
                                    PsiElement(,)(',')
                                    R_SUB
                                      R_EXPR
                                        PsiElement(NUM_CONST)('0.999')
                                  PsiElement())(')')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(NUM_CONST)('2')
                              PsiElement(,)(',')
                              R_SUB
                                PsiElement(SYMBOL)('byrow')
                                PsiElement(=)('=')
                                R_EXPR
                                  PsiElement(SYMBOL)('TRUE')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('Symbols')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('state_model')
                            PsiElement($)('$')
                            PsiElement(SYMBOL)('amacid')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('EmissionProbs')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('matrix')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('c')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('state_model')
                                        PsiElement($)('$')
                                        PsiElement(SYMBOL)('prion_frequency')
                                    PsiElement(,)(',')
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('state_model')
                                        PsiElement($)('$')
                                        PsiElement(SYMBOL)('frequency')
                                  PsiElement())(')')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(NUM_CONST)('2')
                              PsiElement(,)(',')
                              R_SUB
                                PsiElement(SYMBOL)('byrow')
                                PsiElement(=)('=')
                                R_EXPR
                                  PsiElement(SYMBOL)('TRUE')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      PsiComment(COMMENT)('# EmissionProbs <- EmissionProbs/rowSums(EmissionProbs)')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('prion_hmm')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('initHMM')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('States')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('Symbols')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('StartProbs')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('TransProbs')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('EmissionProbs')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('return')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('prion_hmm')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.tsv')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('df')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('...')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('write.table')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('df')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('row.names')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(SYMBOL)('FALSE')
                            PsiElement(,)(',')
                            R_SUB
                              PsiElement(SYMBOL)('sep')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(STR_CONST)('"\t"')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('...')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## set the base directory for the analysis')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EQUAL_ASSIGN
            R_EXPR
              PsiElement(SYMBOL)('baseDirectory')
            PsiElement(=)('=')
            R_EXPR_OR_ASSIGN
              R_EXPR
                PsiElement(STR_CONST)('"~/DropBox/prion_domains/"')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('#####################################################################')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### S. Cerevisiae')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('paste')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('baseDirectory')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"S_cerevisiae"')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('sep')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('""')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## read the protein data')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# scer_proteome <- createPyTable("../code/fasta2table.py orf_trans.fasta", stringsAsFactors=FALSE, col.names=c("GeneDesc","Sequence"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('scer_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('readFastaIntoDF')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"orf_trans.fasta"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('scer_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteome')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_split_fixed')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('" "')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement())(')')
                    PsiElement([)('[')
                    PsiElement(,)(',')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('1')
                    PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# write.fasta(Scer_proteome$GeneDesc, Scer_proteome$Sequence, "scer_proteome.fasta") ## write it to disk for cdd analysis')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('arrange')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('as.data.frame')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('table')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('scer_proteome')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('GeneDesc')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('Freq')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## Build the HMM')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# scer_bcknd_freqs <- createPyTable("../code/count_frequencies.py orf_trans.fasta", stringsAsFactors=FALSE, col.names=c("amacid","frequency"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('scer_bcknd_freqs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('calcASFreqDist')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteome')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('Sequence')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('scer_state_model')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prion_model')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_bcknd_freqs')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"amacid"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('prion_s_cer_hmm')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('createPrionHMM')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_state_model')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('rename')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('melt')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('scer_state_model')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('c')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            PsiElement(SYMBOL)('variable')
                            PsiElement(=)('=')
                            R_EXPR
                              PsiElement(STR_CONST)('"state"')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('amacid')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('value')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fill')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('state')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('position')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"dodge"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"S. Cerivisae HMM state opdfs"')
                PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
    PsiComment(COMMENT)('## Run the HMM predcition of domains')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('scer_proteome_path')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('adply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteome')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(NUM_CONST)('1')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('splat')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('runHMM')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('hmm')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('prion_s_cer_hmm')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('save')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('scer_proteome_path')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"scer_proteome_path.RData"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# print(load("scer_proteome_path.RData"))')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('scer_proteins_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteome_path')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('str_detect')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Segmentation')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"P{60,}"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('scer_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"scer_proteins_with_pdomain.csv"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('### overlap our results with the results from the paper')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('paper_prots_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('file')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"../Original_paper/Oliver's list new version1.csv"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('header')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('stringsAsFactors')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('FALSE')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('paper_prots_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('paper_prots_with_pdomain')
              PsiElement([)('[')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(NUM_CONST)('1')
                    PsiElement(:)(':')
                    R_EXPR
                      PsiElement(NUM_CONST)('179')
              PsiElement(,)(',')
              PsiElement(])(']')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('paper_prots_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('paper_prots_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('CORE')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('as.numeric')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('CORE')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('select')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('geneID')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('geneName')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('CORE')
                    PsiElement())(')')
              PsiElement())(')')
        PsiComment(COMMENT)('## keep just the important columns ')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('scer_proteins_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteins_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('locus_tag')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_split_fixed')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"_"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement())(')')
                    PsiElement([)('[')
                    PsiElement(,)(',')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('1')
                    PsiElement(])(']')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('gene_symbol')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_split_fixed')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"_"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement())(')')
                    PsiElement([)('[')
                    PsiElement(,)(',')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('#### is there any overlap between disc and purp?')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('## overlap by gene symbol')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('protein_overlap')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteins_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('paper_prots_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"gene_symbol"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.y')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"geneName"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('all')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('protein_overlap')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protein_overlap')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('select')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(-)('-')
                    R_EXPR
                      PsiElement(SYMBOL)('c')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('Sequence')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('Segmentation')
                      PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('notMappedRev')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protein_overlap')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(!)('!')
                    R_EXPR
                      PsiElement(SYMBOL)('is.na')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('GeneDesc')
                      PsiElement())(')')
                      PsiElement(&)('&')
                      R_EXPR
                        PsiElement(SYMBOL)('is.na')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('CORE')
                        PsiElement())(')')
              PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('notMappedRev')
                  PsiElement([)('[')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('order')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('notMappedRev')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('gene_symbol')
                        PsiElement())(')')
                  PsiElement(,)(',')
                  PsiElement(])(']')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('select')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('gene_symbol')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('locus_tag')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('notMappedPaper')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protein_overlap')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('is.na')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                    PsiElement())(')')
                    PsiElement(&)('&')
                    R_EXPR
                      PsiElement(!)('!')
                      R_EXPR
                        PsiElement(SYMBOL)('is.na')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('CORE')
                        PsiElement())(')')
              PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('notMappedPaper')
                  PsiElement([)('[')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('order')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('notMappedPaper')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('gene_symbol')
                        PsiElement())(')')
                  PsiElement(,)(',')
                  PsiElement(])(']')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('select')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('gene_symbol')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('geneID')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('scer_hits_combined')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('list')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('new')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteins_with_pdomain')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('gene_symbol')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('paper')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('paper_prots_with_pdomain')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('geneName')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# dictHits <- dlply(dict_proteins_with_pdomain, .(species), function(x) x$GeneDesc)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('vPlot')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('venn.diagram')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('scer_hits_combined')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('filename')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NULL_CONST)('NULL')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('fill')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"cornflowerblue"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"darkorchid1"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiComment(COMMENT)('#')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('grid.newpage')
            PsiElement(()('(')
            R_SUBLIST
              <empty list>
            PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('grid.draw')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('vPlot')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## plot the correlation between the scores')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('protein_overlap')
                  PsiElement([)('[')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('complete.cases')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('protein_overlap')
                        PsiElement())(')')
                  PsiElement(,)(',')
                  PsiElement(])(']')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('as.numeric')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('maxRollPScore')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('CORE')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_point')
              PsiElement(()('(')
              R_SUBLIST
                <empty list>
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"ratio score correlation"')
                PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('with')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('protein_overlap')
                  PsiElement([)('[')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('complete.cases')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('protein_overlap')
                        PsiElement())(')')
                  PsiElement(,)(',')
                  PsiElement(])(']')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('Kendall')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('as.numeric')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('maxRollPScore')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('CORE')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
    PsiComment(COMMENT)('## overlap by locus tag')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('protein_overlap')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteins_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('paper_prots_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"locus_tag"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.y')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"geneID"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('all')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# protein_overlap <- subset(protein_overlap, select=-c(Sequence, Segmentation))')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('notMappedRev')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protein_overlap')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(!)('!')
                    R_EXPR
                      PsiElement(SYMBOL)('is.na')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('GeneDesc')
                      PsiElement())(')')
                      PsiElement(&)('&')
                      R_EXPR
                        PsiElement(SYMBOL)('is.na')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('CORE')
                        PsiElement())(')')
              PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('notMappedRev')
                  PsiElement([)('[')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('order')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('notMappedRev')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('gene_symbol')
                        PsiElement())(')')
                  PsiElement(,)(',')
                  PsiElement(])(']')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('select')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('locus_tag')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('gene_symbol')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('notMappedPaper')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protein_overlap')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('is.na')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                    PsiElement())(')')
                    PsiElement(&)('&')
                    R_EXPR
                      PsiElement(!)('!')
                      R_EXPR
                        PsiElement(SYMBOL)('is.na')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('CORE')
                        PsiElement())(')')
              PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('notMappedPaper')
                  PsiElement([)('[')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('order')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('notMappedPaper')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('gene_symbol')
                        PsiElement())(')')
                  PsiElement(,)(',')
                  PsiElement(])(']')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('select')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('locus_tag')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('geneName')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('scer_hits_combined')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('list')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('new')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('scer_proteins_with_pdomain')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('locus_tag')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('paper')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('paper_prots_with_pdomain')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('geneID')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# dictHits <- dlply(dict_proteins_with_pdomain, .(species), function(x) x$GeneDesc)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('vPlot')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('venn.diagram')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('scer_hits_combined')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('filename')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NULL_CONST)('NULL')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('fill')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"cornflowerblue"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"darkorchid1"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiComment(COMMENT)('#')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('grid.newpage')
            PsiElement(()('(')
            R_SUBLIST
              <empty list>
            PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('grid.draw')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('vPlot')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('#####################################################################')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### Dictyostelium discoideum')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('paste')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('baseDirectory')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"Dicty/discoideum"')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('sep')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('""')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
    PsiComment(COMMENT)('## load the complete protoeme')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_disc_proteome <- createPyTable("../../code/fasta2table.py dicty_primary_protein_created_07-05-2011.fasta", stringsAsFactors=FALSE, col.names=c("GeneDesc","Sequence"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dict_disc_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('readFastaIntoDF')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"dicty_primary_protein_created_07-05-2011.fasta"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## fix the ids')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dict_disc_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_disc_proteome')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_split_fixed')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"[|]"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('3')
                    PsiElement())(')')
                    PsiElement([)('[')
                    PsiElement(,)(',')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dict_disc_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_disc_proteome')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_trim')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# arrange(as.data.frame(table(dict_disc_proteome$GeneDesc)), Freq)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n\n')
          PsiComment(COMMENT)('## remove the shorter transcripts for the ~30 genes with multiple isoforms')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('selectTranscripts')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('gene')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  R_EXPR
                    PsiElement({)('{')
                    R_EXPRLIST
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(IF)('if')
                          R_IFCOND
                            PsiElement(()('(')
                            R_EXPR
                              PsiElement(SYMBOL)('nrow')
                              PsiElement(()('(')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(SYMBOL)('gene')
                              PsiElement())(')')
                              PsiElement(==)('==')
                              R_EXPR
                                PsiElement(NUM_CONST)('1')
                            PsiElement())(')')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement({)('{')
                              R_EXPRLIST
                                R_EXPR_OR_ASSIGN
                                  R_EXPR
                                    PsiElement(SYMBOL)('return')
                                    PsiElement(()('(')
                                    R_SUBLIST
                                      R_SUB
                                        R_EXPR
                                          PsiElement(SYMBOL)('gene')
                                    PsiElement())(')')
                              PsiElement(})('}')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('seqLens')
                          PsiElement(<-)('<-')
                          R_EXPR
                            PsiElement(SYMBOL)('nchar')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('gene')
                                  PsiElement($)('$')
                                  PsiElement(SYMBOL)('Sequence')
                            PsiElement())(')')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('# DEBUG  gene <- subset(dict_disc_proteome, GeneDesc=="DDB_G0293378")')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(IF)('if')
                          R_IFCOND
                            PsiElement(()('(')
                            R_EXPR
                              PsiElement(SYMBOL)('gene')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('GeneDesc')
                              PsiElement([)('[')
                              R_SUBLIST
                                R_SUB
                                  R_EXPR
                                    PsiElement(NUM_CONST)('1')
                              PsiElement(])(']')
                              PsiElement(==)('==')
                              R_EXPR
                                PsiElement(STR_CONST)('"DDB_G0293378"')
                            PsiElement())(')')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement({)('{')
                              R_EXPRLIST
                                R_EXPR_OR_ASSIGN
                                  PsiElement(EOL)('\n')
                                  R_EXPR
                                    PsiElement(SYMBOL)('return')
                                    PsiElement(()('(')
                                    R_SUBLIST
                                      R_SUB
                                        R_EXPR
                                          PsiElement(SYMBOL)('gene')
                                          PsiElement([)('[')
                                          R_SUBLIST
                                            R_SUB
                                              R_EXPR
                                                PsiElement(SYMBOL)('which')
                                                PsiElement(()('(')
                                                R_SUBLIST
                                                  R_SUB
                                                    R_EXPR
                                                      PsiElement(SYMBOL)('seqLens')
                                                      PsiElement(==)('==')
                                                      R_EXPR
                                                        PsiElement(SYMBOL)('min')
                                                        PsiElement(()('(')
                                                        R_SUBLIST
                                                          R_SUB
                                                            R_EXPR
                                                              PsiElement(SYMBOL)('seqLens')
                                                        PsiElement())(')')
                                                PsiElement())(')')
                                          PsiElement(,)(',')
                                          PsiElement(])(']')
                                    PsiElement())(')')
                                PsiElement(EOL)('\n')
                              PsiElement(})('}')
                      PsiElement(EOL)('\n')
                      R_EXPR_OR_ASSIGN
                        PsiElement(EOL)('\n')
                        PsiComment(COMMENT)('# return the longer transcript as default ')
                        PsiElement(EOL)('\n')
                        R_EXPR
                          PsiElement(SYMBOL)('return')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('gene')
                                PsiElement([)('[')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('which')
                                      PsiElement(()('(')
                                      R_SUBLIST
                                        R_SUB
                                          R_EXPR
                                            PsiElement(SYMBOL)('seqLens')
                                            PsiElement(==)('==')
                                            R_EXPR
                                              PsiElement(SYMBOL)('max')
                                              PsiElement(()('(')
                                              R_SUBLIST
                                                R_SUB
                                                  R_EXPR
                                                    PsiElement(SYMBOL)('seqLens')
                                              PsiElement())(')')
                                      PsiElement())(')')
                                PsiElement(,)(',')
                                PsiElement(])(']')
                          PsiElement())(')')
                      PsiElement(EOL)('\n')
                    PsiElement(})('}')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dict_disc_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_disc_proteome')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('selectTranscripts')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# write.fasta(dict_disc_proteome$GeneDesc, dict_disc_proteome$Sequence, "dict_disc_proteome.fasta") ## dump proteome with fixed ids for later cdd analysis')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n\n')
          PsiComment(COMMENT)('# Build the HMM')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ddisc_bcknd_freqs <- createPyTable("../../code/count_frequencies.py dicty_primary_protein_created_07-05-2011.fasta", stringsAsFactors=FALSE, col.names=c("amacid","frequency"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ddisc_bcknd_freqs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('calcASFreqDist')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_disc_proteome')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('Sequence')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# ##### build a custom prion model')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# seqs_for_custom_prion_model <- readFastaIntoDF("N-richPrD2.txt")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# prion_model_new <- calcASFreqDist(seqs_for_custom_prion_model$Sequence)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# prion_model= data.frame(amacid=c("A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "V", "W", "Y"),')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# prion_frequency=c(2.868827, 1.371914, 2.748457, 1.498457, 2.248457, 6.861111, 1.998457, 2.373457, 2.121914, 1.496914, 4.123457, 37.956790, 3.496914, 5.240741, 2.745370, 8.612654, 3.118827, 2.123457, 1.373457, 5.620370))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# \t')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ## change the working directory to avoid that we override existing results')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# newResultDirectory <- "newmodel3"')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dir.create(newResultDirectory)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# setwd(newResultDirectory)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# #seqs_for_custom_prion_model <- readFastaIntoDF("/Users/malinovs/Desktop/N-richPrD.txt")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# #prion_model_new <- calcASFreqDist(seqs_for_custom_prion_model$Sequence)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# #')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ### change the working directory to avoid that we override existing results')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# newResultDirectory <- "newmodel"')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dir.create(newResultDirectory)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# setwd(newResultDirectory)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ######')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('ddisc_state_model')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prion_model')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ddisc_bcknd_freqs')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"amacid"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ddisc_state_model')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rbind')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ddisc_state_model')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_specific_amacids')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('prion_d_disc_hmm')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('createPrionHMM')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ddisc_state_model')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# visualize the state opdfs')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('rename')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('melt')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('ddisc_state_model')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('c')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            PsiElement(SYMBOL)('variable')
                            PsiElement(=)('=')
                            R_EXPR
                              PsiElement(STR_CONST)('"state"')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('amacid')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('value')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fill')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('state')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('position')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"dodge"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"Dictyostelium discoideum HMM state opdfs"')
                PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"dict_disc_hmm.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## run the hmm analysis')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dict_disc_paths')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('adply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_disc_proteome')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(NUM_CONST)('1')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('splat')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('runHMM')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('hmm')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('prion_d_disc_hmm')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('save')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('dict_disc_paths')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"dict_disc_paths.RData"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('##if using prion_model_new :)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_disc_new_paths <- adply(dict_disc_proteome, 1, splat(runHMM), hmm=prion_model_new, .progress="text")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# save(dict_disc_new_paths, file="dict_disc_new_paths.RData")')
          PsiElement(EOL)('\n\n\n')
          PsiComment(COMMENT)('# # expand the gene description column')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_disc_paths <- transform(dict_disc_paths, dicty_id = str_split_fixed(GeneDesc, "[|]",3)[,1], dicty_gene_symbol = str_split_fixed(GeneDesc, "[|]",3)[,2])')
          PsiElement(EOL)('\n')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('## filter for proteins which have at least 60 consecutive Ps')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dict_disc_proteins_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_disc_paths')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('str_detect')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Segmentation')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"P{60,}"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('dict_disc_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"dict_disc_proteins_with_pdomain.csv"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# ## extend the table by adding available gene information from ncbi')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# idFile=tempfile()')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# write.table(str_split_fixed(dict_disc_proteins_with_pdomain$GeneDesc, "[|]",3)[1:100,2], file=idFile, row.names=FALSE, col.names=FALSE)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# ddic_mapped_ids <- createPyTable(paste("../../code/map_dictybase_ids.py ", idFile), stringsAsFactors=FALSE, sep = "\t")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# unlink(idFile)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# save(ddic_mapped_ids, file="ddic_mapped_ids.RData")')
          PsiElement(EOL)('\n\n\n')
          PsiComment(COMMENT)('# ## xout prion domains and write a fasta file')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_disc_proteins_with_xout_pdomain <- xout_pdomains(dict_disc_proteins_with_pdomain)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# # dd_prot_chunks <- split(dict_disc_proteins_with_xout_pdomain, factor(sort(floor(1:nrow(dict_disc_proteins_with_xout_pdomain)/400)))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# xout_seqs <- AAStringSet(dict_disc_proteins_with_xout_pdomain$prion_xout_sequence)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# names(xout_seqs) <- dict_disc_proteins_with_xout_pdomain$dicty_gene_symbol;')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# write.XStringSet(xout_seqs, file=paste("xout_p_domains_all.fasta", sep=""), format="fasta", width=80)')
          PsiElement(EOL)('\n')
          PsiElement(EOL)('\n\n\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### Dictyostelium purpureum')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('paste')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('baseDirectory')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"Dicty/purpureum"')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('sep')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('""')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## load the proteome')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_purp_proteome <- createPyTable("../../code/fasta2table.py purpureum_protein_created_02-04-2010.fas", stringsAsFactors=FALSE, col.names=c("GeneDesc","Sequence"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dict_purp_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('readFastaIntoDF')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"purpureum_protein_created_02-04-2010.fas"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dict_purp_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_purp_proteome')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_split_fixed')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"[|]"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('3')
                    PsiElement())(')')
                    PsiElement([)('[')
                    PsiElement(,)(',')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dict_purp_proteome')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_purp_proteome')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_trim')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('GeneDesc')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# write.fasta(dict_purp_proteome$GeneDesc, dict_purp_proteome$Sequence, "dict_purp_proteome.fasta") ## dump proteome with fixed ids for later cdd analysis')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('arrange')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('as.data.frame')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('table')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('dict_purp_proteome')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('GeneDesc')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('Freq')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
    PsiComment(COMMENT)('## estimate the background amino acid distribution and create the hmm')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dpurp_bcknd_freqs <- createPyTable("../../code/count_frequencies.py purpureum_protein_created_02-04-2010.fas", stringsAsFactors=FALSE, col.names=c("amacid","frequency"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dpurp_bcknd_freqs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('calcASFreqDist')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_purp_proteome')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('Sequence')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dpurp_state_model')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prion_model_new')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dpurp_bcknd_freqs')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"amacid"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dpurp_state_model')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rbind')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dpurp_state_model')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_specific_amacids')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('prion_d_purp_hmm')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('createPrionHMM')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dpurp_state_model')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# visualize the state opdfs')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('rename')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('melt')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('dpurp_state_model')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('c')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            PsiElement(SYMBOL)('variable')
                            PsiElement(=)('=')
                            R_EXPR
                              PsiElement(STR_CONST)('"state"')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('amacid')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('value')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fill')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('state')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('position')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"dodge"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"Dictyostelium purpureum HMM state opdfs"')
                PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# tt <- subset(dict_purp_proteome, GeneDesc=="DPU0053091|DPU_G0053090_|Protein|gene:")')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('## run the analysis (paths + scores)')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('dict_purp_paths')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('adply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dict_purp_proteome')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(NUM_CONST)('1')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('splat')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('runHMM')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('hmm')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('prion_d_purp_hmm')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('save')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('dict_purp_paths')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"dict_purp_paths.RData"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## filter for proteins which have at least 60 consecutive Ps')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('purp_disc_proteins_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('purp_disc_paths')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('str_detect')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Segmentation')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"P{60,}"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('purp_disc_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"purp_disc_proteins_with_pdomain.csv"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('#####################################################################')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### Postprocess all HMM results together')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('baseDirectory')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('print')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('load')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"Dicty/purpureum/dict_purp_paths.RData"')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('print')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('load')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"Dicty/discoideum/dict_disc_paths.RData"')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('print')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('load')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"S_cerevisiae/scer_proteome_path.RData"')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# print(load("Dicty/discoideum/newmodel3/dict_disc_new_paths.RData"))')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"results"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# # prepare proper gene ids')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_purp_paths <- transform(dict_purp_paths, gene_id=str_split_fixed(GeneDesc, "[|]", 3)[,2])')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_purp_paths <- transform(dict_purp_paths, gene_id=substr(gene_id, 1, nchar(gene_id)-1))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_disc_paths <- transform(dict_disc_paths, gene_id=str_split_fixed(GeneDesc, "[|]", 3)[,2])')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# dict_disc_paths <- transform(dict_disc_paths, gene_id=substr(gene_id, 1, nchar(gene_id)-1))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# scer_proteome_path <- transform(scer_proteome_path, gene_id=str_split_fixed(GeneDesc, "_",2)[,1])')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('##comparing prion_model and prion_model_new in D.discoideum')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('all_species_paths')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rbind')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('dict_disc_paths')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('species')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"d. discoideum"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('dict_purp_paths')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('species')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"d. purpureum"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('scer_proteome_path')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('species')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"s. cerivisae"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('##for newmodel')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#all_species_paths <- rbind(transform(dict_disc_new_paths, species="d. discoideum N-rich"), transform(dict_disc_paths, species="d. discoideum"),transform(dict_purp_paths, species="d. purpureum"), transform(scer_proteome_path, species="s. cerivisae"))')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('table')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_paths')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('species')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# visualize the length distributions of all 3 proteomes')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('all_species_paths')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_species_paths')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('prot_length')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('nchar')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Sequence')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('subset')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('all_species_paths')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('prot_length')
                        PsiElement(<)('<')
                        R_EXPR
                          PsiElement(NUM_CONST)('5000')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('prot_length')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fill')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('str_detect')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('Segmentation')
                          PsiElement(,)(',')
                          R_SUB
                            R_EXPR
                              PsiElement(STR_CONST)('"P{60,}"')
                        PsiElement())(')')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_histogram')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('binwidth')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NUM_CONST)('50')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('facet_wrap')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(~)('~')
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('nrow')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('3')
                PsiElement())(')')
                PsiElement(+)('+')
                R_EXPR
                  PsiElement(SYMBOL)('opts')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      PsiElement(SYMBOL)('title')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('"Protein length distributions"')
                  PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"Protein length distributions.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## save the merged data-set (protein sequences and classification for all species)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('save')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_paths')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('".all_species_paths.RData"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
  PsiComment(COMMENT)('## filter for proteins which have at least 60 consecutive Ps')
  PsiElement(DUMMY_BLOCK)
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_species_paths')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('str_detect')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Segmentation')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"P{60,}"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('table')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('species')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"all_species_proteins_with_pdomain.tsv"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('row.names')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('FALSE')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('## write fasta for later geneious import')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('write.fasta')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('GeneDesc')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('Sequence')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"all_species_proteins_with_pdomain.fasta"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## visualize the score distribution')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('as.numeric')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('maxRollPScore')
                        PsiElement())(')')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_histogram')
              PsiElement(()('(')
              R_SUBLIST
                <empty list>
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('facet_wrap')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(~)('~')
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('scales')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"free_y"')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('nrow')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('3')
                PsiElement())(')')
                PsiElement(+)('+')
                R_EXPR
                  PsiElement(SYMBOL)('opts')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      PsiElement(SYMBOL)('title')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('"Maximum moving average score distribution (w=60) of proteins with at least one prion domain"')
                  PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"hmm score distributions of prion domain proteins.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('## count and visualize how many domains have been predicted per gene')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('prots_with_pdomsegs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('extractDomainSegs')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## add the domain sequnece')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('prots_with_pdomsegs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prots_with_pdomsegs')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('domain_seq')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('substr')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Sequence')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('start')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('end')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('table')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('as.data.frame')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('table')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('prots_with_pdomsegs')
                              PsiElement($)('$')
                              PsiElement(SYMBOL)('GeneDesc')
                        PsiElement())(')')
                  PsiElement())(')')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('Freq')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('ddply')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('prots_with_pdomsegs')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('.')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('GeneDesc')
                          PsiElement(,)(',')
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('species')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('summarize')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('num_domains')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('length')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('GeneDesc')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('factor')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('num_domains')
                        PsiElement())(')')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                <empty list>
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('facet_wrap')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(~)('~')
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('ncol')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('4')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('scales')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"free"')
                PsiElement())(')')
                PsiElement(+)('+')
                R_EXPR
                  PsiElement(SYMBOL)('scale_y_continuous')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      PsiElement(SYMBOL)('name')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('"# genes"')
                  PsiElement())(')')
                  PsiElement(+)('+')
                  R_EXPR
                    PsiElement(SYMBOL)('opts')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('title')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"Prion domain counts per gene"')
                    PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"prion domains counts per gene.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## get the folding probability from foldindex for each domain')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# foldIndexDoc <- xmlTreeParse("http://bioportal.weizmann.ac.il/fldbin/findex?m=xml&sq=SFALYVSAFALGFPLNLLAIRGAVSHAKLRLTPSL", getDTD = F, isURL=TRUE)')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('library')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('XML')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('prots_with_pdomsegs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('adply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prots_with_pdomsegs')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(NUM_CONST)('1')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('splat')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          R_FUNDEF
                            PsiElement(FUNCTION)('function')
                            PsiElement(()('(')
                            R_FORMLIST
                              R_FORM
                                PsiElement(SYMBOL)('domain_seq')
                              PsiElement(,)(',')
                              R_FORM
                                PsiElement(SYMBOL)('...')
                            PsiElement())(')')
                            R_EXPR_OR_ASSIGN
                              R_EXPR
                                PsiElement({)('{')
                                R_EXPRLIST
                                  R_EXPR_OR_ASSIGN
                                    PsiElement(EOL)('\n')
                                    R_EXPR
                                      PsiElement(SYMBOL)('foldIndexDoc')
                                      PsiElement(<-)('<-')
                                      R_EXPR
                                        PsiElement(SYMBOL)('xmlTreeParse')
                                        PsiElement(()('(')
                                        R_SUBLIST
                                          R_SUB
                                            R_EXPR
                                              PsiElement(SYMBOL)('paste')
                                              PsiElement(()('(')
                                              R_SUBLIST
                                                R_SUB
                                                  R_EXPR
                                                    PsiElement(STR_CONST)('"http://bioportal.weizmann.ac.il/fldbin/findex?m=xml&sq="')
                                                PsiElement(,)(',')
                                                R_SUB
                                                  R_EXPR
                                                    PsiElement(SYMBOL)('domain_seq')
                                                PsiElement(,)(',')
                                                R_SUB
                                                  PsiElement(SYMBOL)('sep')
                                                  PsiElement(=)('=')
                                                  R_EXPR
                                                    PsiElement(STR_CONST)('""')
                                              PsiElement())(')')
                                          PsiElement(,)(',')
                                          R_SUB
                                            PsiElement(SYMBOL)('getDTD')
                                            PsiElement(=)('=')
                                            R_EXPR
                                              PsiElement(SYMBOL)('F')
                                          PsiElement(,)(',')
                                          R_SUB
                                            PsiElement(SYMBOL)('isURL')
                                            PsiElement(=)('=')
                                            R_EXPR
                                              PsiElement(SYMBOL)('TRUE')
                                        PsiElement())(')')
                                  PsiElement(EOL)('\n')
                                  R_EXPR_OR_ASSIGN
                                    R_EXPR
                                      PsiElement(SYMBOL)('return')
                                      PsiElement(()('(')
                                      R_SUBLIST
                                        R_SUB
                                          R_EXPR
                                            PsiElement(SYMBOL)('c')
                                            PsiElement(()('(')
                                            R_SUBLIST
                                              R_SUB
                                                PsiElement(SYMBOL)('foldIndex')
                                                PsiElement(=)('=')
                                                R_EXPR
                                                  PsiElement(SYMBOL)('as.numeric')
                                                  PsiElement(()('(')
                                                  R_SUBLIST
                                                    R_SUB
                                                      R_EXPR
                                                        PsiElement(SYMBOL)('xmlValue')
                                                        PsiElement(()('(')
                                                        R_SUBLIST
                                                          R_SUB
                                                            R_EXPR
                                                              PsiElement(SYMBOL)('foldIndexDoc')
                                                              PsiElement([[)('[[')
                                                              R_SUBLIST
                                                                R_SUB
                                                                  R_EXPR
                                                                    PsiElement(NUM_CONST)('1')
                                                              PsiElement(]])(']]')
                                                              PsiElement([[)('[[')
                                                              R_SUBLIST
                                                                R_SUB
                                                                  R_EXPR
                                                                    PsiElement(NUM_CONST)('1')
                                                              PsiElement(]])(']]')
                                                        PsiElement())(')')
                                                  PsiElement())(')')
                                            PsiElement())(')')
                                      PsiElement())(')')
                                  PsiElement(EOL)('\n')
                                PsiElement(})('}')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.tsv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdomsegs')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"predicted_prion_domains_all_species.tsv"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# prots_with_pdomsegs <- read.table("predicted_prion_domains_all_species.tsv", header=TRUE)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('prots_with_pdomsegs_unfolded')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prots_with_pdomsegs')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('foldIndex')
                    PsiElement(<)('<')
                    R_EXPR
                      PsiElement(NUM_CONST)('0')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdomsegs')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('as.numeric')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('foldIndex')
                        PsiElement())(')')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_histogram')
              PsiElement(()('(')
              R_SUBLIST
                <empty list>
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('facet_wrap')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(~)('~')
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('ncol')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('3')
                PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"fold index distribution per species.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('#####################################################################')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### Domain prediction and enrichment analysis')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n\n\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('paste')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('baseDirectory')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"results"')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('sep')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('""')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('domains_dpurp')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('paste')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('baseDirectory')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"Dicty/purpureum/cdd_hitdata_concise_dpurp.txt"')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('sep')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('""')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('sep')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)(''\t'')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('fill')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('header')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('skip')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NUM_CONST)('7')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('domains_ddict')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('paste')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('baseDirectory')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"Dicty/discoideum/cdd_hitdata_concise_ddict.txt"')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('sep')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('""')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('sep')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)(''\t'')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('fill')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('header')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('skip')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NUM_CONST)('7')
              PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('domains_scerv')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('paste')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('baseDirectory')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"S_cerevisiae/cdd_hitdata_concise_scerv.txt"')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('sep')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('""')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('sep')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)(''\t'')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('fill')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('header')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('skip')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NUM_CONST)('7')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## combine the data sets and extract the ids')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('domains_all')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rbind')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('domains_scerv')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('species')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"s. cerivisae"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('domains_ddict')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('species')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"d. discoideum"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('domains_dpurp')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('species')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"d. purpureum"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('##for newmodel')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#domains_all <- rbind(transform(domains_scerv, species="s. cerivisae"), transform(domains_ddict, species="d. discoideum"),transform(domains_ddict, species="d. discoideum N-rich"), transform(domains_dpurp, species="d. purpureum"))')
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('domains_all')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('gene_id')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_match')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Query')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('".*>(.*)"')
                    PsiElement())(')')
                    PsiElement([)('[')
                    PsiElement(,)(',')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('2')
                    PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## load all protoemes and the sets of proteins for each organism that have at least one prion domain')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('print')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('load')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('".all_species_paths.RData"')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('file')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"all_species_proteins_with_pdomain.tsv"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## keep just the super families but remove the word superfamiliy from the (short) name')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('domains_all_sf')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('Hit.type')
                    PsiElement(==)('==')
                    R_EXPR
                      PsiElement(STR_CONST)('"superfamily"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('domains_all_sf')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all_sf')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Short.name')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('str_trim')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('str_replace')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('Short.name')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(STR_CONST)('"superfamily"')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(STR_CONST)('""')
                          PsiElement())(')')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.tsv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('domains_all_sf')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"cdd_superfamily_domains_all_species.csv"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## prepare the enrichment analysis by counting proteins in total and in hitlist\t')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('proteome_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rename')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('as.data.frame')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('with')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('all_species_paths')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('table')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('species')
                                PsiElement())(')')
                          PsiElement())(')')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('Freq')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"num_proteins"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('domain_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rename')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('as.data.frame')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('with')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('domains_all_sf')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('table')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('species')
                                PsiElement())(')')
                          PsiElement())(')')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('Freq')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"num_domains"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('norm_domain_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('merge')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('proteome_counts')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('domain_counts')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('by')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('doms_per_prot')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('num_domains')
                    PsiElement(/)('/')
                    R_EXPR
                      PsiElement(SYMBOL)('num_proteins')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('domains_all_sf')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                <empty list>
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"Numbers of predicted domains per organism"')
                PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"enrichment analysis - Numbers of predicted domains per organism.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('norm_domain_counts')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('doms_per_prot')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"Normalized number of domains per protein in each organsim"')
                PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"enrichment analysis - Normalized number of domains per protein in each organsim.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## create a tag cloud of frequent domains')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ccd_mult_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('table')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('subset')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('domains_all_sf')
                    PsiElement())(')')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('Short.name')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ccd_mult_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('log')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ccd_mult_counts')
                    PsiElement([)('[')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('ccd_mult_counts')
                          PsiElement(>)('>')
                          R_EXPR
                            PsiElement(NUM_CONST)('25')
                    PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('cloud')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('ccd_mult_counts')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('col')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('col.br')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('ccd_mult_counts')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fit')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('TRUE')
                  PsiElement())(')')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## collect the different statistics necessary to do the enrichment analysis')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('familiy_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all_sf')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('summarize')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('num_domains')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('length')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('familiy_total_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all_sf')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('summarize')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('tot_num_domains')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('length')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('all_priprots_with_domains')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all_sf')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"GeneDesc"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.y')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"gene_id"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('all_priprots_domain_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_priprots_with_domains')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('summarize')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('num_domains')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('length')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('all_priprots_total_counts')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_priprots_with_domains')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('summarize')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('tot_num_domains')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('length')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## prepare the data for the enrichemn')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('urn')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('familiy_counts')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('familiy_total_counts')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('drawn_sample')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_priprots_domain_counts')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('all_priprots_total_counts')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('urn_model')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('urn')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('drawn_sample')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('suffixes')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"_proteome"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"_prionprots"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"Short.name"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# Note: why q-1, because we want to have Pr(X>=x) instead of Pr(X>x)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('calcDomainEnrichemnt')
            PsiElement(<-)('<-')
            R_EXPR
              R_FUNDEF
                PsiElement(FUNCTION)('function')
                PsiElement(()('(')
                R_FORMLIST
                  R_FORM
                    PsiElement(SYMBOL)('num_domains_proteome')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('tot_num_domains_proteome')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('num_domains_prionprots')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('tot_num_domains_prionprots')
                  PsiElement(,)(',')
                  R_FORM
                    PsiElement(SYMBOL)('...')
                PsiElement())(')')
                R_EXPR_OR_ASSIGN
                  PsiElement(EOL)('\n')
                  R_EXPR
                    PsiElement(SYMBOL)('phyper')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('num_domains_prionprots')
                          PsiElement(-)('-')
                          R_EXPR
                            PsiElement(NUM_CONST)('1')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('num_domains_proteome')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('tot_num_domains_proteome')
                          PsiElement(-)('-')
                          R_EXPR
                            PsiElement(SYMBOL)('num_domains_proteome')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('tot_num_domains_prionprots')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('lower.tail')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(SYMBOL)('FALSE')
                    PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('domain_enrichment')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rename')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('adply')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('urn_model')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(NUM_CONST)('1')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('splat')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('calcDomainEnrichemnt')
                          PsiElement())(')')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('V1')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"p_value"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('domain_enrichment')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"domain_super_familiy_enrichment.csv"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# domain_enrichment = read.csv("results/domain_super_familiy_enrichment.csv")')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('# keep just the overrepresented terms')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('sig_domain_enrichment')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domain_enrichment')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('p_value')
                    PsiElement(<)('<')
                    R_EXPR
                      PsiElement(NUM_CONST)('0.01')
              PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('write.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('sig_domain_enrichment')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"overrep_domain_super_families_cutoff0.01.csv"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('row.names')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('FALSE')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('sig_domain_enrichment')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('Short.name')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('p_value')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('width')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(NUM_CONST)('0.3')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('facet_wrap')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(~)('~')
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('ncol')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('4')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('scale')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"free"')
                PsiElement())(')')
                PsiElement(+)('+')
                R_EXPR
                  PsiElement(SYMBOL)('coord_flip')
                  PsiElement(()('(')
                  R_SUBLIST
                    <empty list>
                  PsiElement())(')')
                  PsiElement(+)('+')
                  R_EXPR
                    PsiElement(SYMBOL)('scale_y_continuous')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('formatter')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"comma"')
                      PsiElement(,)(',')
                      R_SUB
                        PsiElement(SYMBOL)('trans')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"log10"')
                    PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"enrichment analysis - enriched superfamilies overview.png"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('width')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(NUM_CONST)('11')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('height')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(NUM_CONST)('9')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## see if there are any terms shared between the different species')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('png')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"enrichment analysis - overlap between enriched superfamilies.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('enrTermLists')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('dlply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('sig_domain_enrichment')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    R_FUNDEF
                      PsiElement(FUNCTION)('function')
                      PsiElement(()('(')
                      R_FORMLIST
                        R_FORM
                          PsiElement(SYMBOL)('x')
                      PsiElement())(')')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('x')
                          PsiElement($)('$')
                          PsiElement(SYMBOL)('Short.name')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# vPlot <- venn.diagram(x = enrTermLists, filename = NULL, fill = c("cornflowerblue", "darkorchid1", "darkgreen", "yellow"))')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('vPlot')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('venn.diagram')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('enrTermLists')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('filename')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NULL_CONST)('NULL')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('fill')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"cornflowerblue"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"darkorchid1"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"darkgreen"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('grid.newpage')
            PsiElement(()('(')
            R_SUBLIST
              <empty list>
            PsiElement())(')')
        PsiElement(;)(';')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('grid.draw')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('vPlot')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dev.off')
            PsiElement(()('(')
            R_SUBLIST
              <empty list>
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## export the domains of an enriched super-family and built a phylogeny in Geneious for it')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#commonEnrDomains <- intersect(intersect(enrTermLists[[1]], enrTermLists[[2]]), enrTermLists[[3]])')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#subset(sig_domsin_enrichment, Short.name %in% commonEnrDomains)')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('#protsWithEnrDomain <- subset(all_priprots_with_domains, Short.name=="SH3")')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#protsWithEnrDomain <- transform(protsWithEnrDomain, domain=substr(Sequence, From, To))')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('# add orthologue information')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#merge(protsWithEnrDomain, slim_ortho_mapping)')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('## remove domains that occur more than once in a single domain')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#protsWithEnrDomainJustOnce <- subset(protsWithEnrDomain, !duplicated(paste(GeneDesc, Short.name, species, sep="|")))')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('# oneSupFam <- transform(oneSupFam, tagsequence = as.character(subseq(DNAStringSet(geneseq_strand_corr), start=tag_window_start, end=tag_window_end)))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#with(protsWithEnrDomainJustOnce, write.fasta(paste(GeneDesc, Short.name, species, sep="|"), domain, "results/SH3domains.fasta")) ')
          PsiElement(EOL)('\n\n\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### AS frequency bias analysis for proteins with prion domains')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('###')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### The analysis is done by grouping based on other predicted domains ')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### for these proteins and by subsequent selection of overrepresented')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('### superfamilies in the set of proteins with prion domains')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('#####################################################################')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('baseDirectory')
            PsiElement())(')')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('setwd')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"results"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## load the results from the last sections ')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# print(load("results/.all_species_paths.RData"))')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# all_species_proteins_with_pdomain <- read.csv(file="results/all_species_proteins_with_pdomain.tsv")')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('prots_with_pdomsegs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.table')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"predicted_prion_domains_all_species.tsv"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('header')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# prots_with_pdomsegs <- subset(prots_with_pdomsegs, select=-c(Segmentation, Sequence))')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('prots_with_pdomsegs')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rename')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prots_with_pdomsegs')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('GeneDesc')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(STR_CONST)('"gene_id"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## calculate the amino acid distribution for all domain in each species to get a background distribution')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('prionBckndASDist')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prots_with_pdomsegs')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    R_FUNDEF
                      PsiElement(FUNCTION)('function')
                      PsiElement(()('(')
                      R_FORMLIST
                        R_FORM
                          PsiElement(SYMBOL)('x')
                      PsiElement())(')')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('calcASFreqDist')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('x')
                                PsiElement($)('$')
                                PsiElement(SYMBOL)('domain_seq')
                          PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('names')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prionBckndASDist')
            PsiElement())(')')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('paste')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('names')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('prionBckndASDist')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"bcknd"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('sep')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"_"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## pick the most signficant terms in each group')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('sig_domain_enrichment')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"overrep_domain_super_families_cutoff0.01.csv"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('sig_domain_enrichment')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('arrange')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('sig_domain_enrichment')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('p_value')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## filter away domains that don't occur frequently ')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('sig_domain_enrichment')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('sig_domain_enrichment')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('num_domains_prionprots')
                    PsiElement(>)('>')
                    R_EXPR
                      PsiElement(NUM_CONST)('6')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('#ggplot(sig_domain_enrichment, aes(num_domains_prionprots)) + geom_histogram(binwidth=1) + facet_wrap(~species, nrow=3)')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('## pick the top ten superfamilies from each species')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('top10')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('sig_domain_enrichment')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    R_FUNDEF
                      PsiElement(FUNCTION)('function')
                      PsiElement(()('(')
                      R_FORMLIST
                        R_FORM
                          PsiElement(SYMBOL)('x')
                      PsiElement())(')')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('x')
                          PsiElement([)('[')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(NUM_CONST)('1')
                                PsiElement(:)(':')
                                R_EXPR
                                  PsiElement(SYMBOL)('min')
                                  PsiElement(()('(')
                                  R_SUBLIST
                                    R_SUB
                                      R_EXPR
                                        PsiElement(SYMBOL)('nrow')
                                        PsiElement(()('(')
                                        R_SUBLIST
                                          R_SUB
                                            R_EXPR
                                              PsiElement(SYMBOL)('x')
                                        PsiElement())(')')
                                    PsiElement(,)(',')
                                    R_SUB
                                      R_EXPR
                                        PsiElement(NUM_CONST)('10')
                                  PsiElement())(')')
                          PsiElement(,)(',')
                          PsiElement(])(']')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('table')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('top10')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('species')
            PsiElement())(')')
        PsiComment(COMMENT)('## just to make sure that the subsetinng worked properly')
        PsiElement(EOL)('\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('shared_terms')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('as.character')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('subset')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('as.data.frame')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('table')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('sig_domain_enrichment')
                                      PsiElement($)('$')
                                      PsiElement(SYMBOL)('Short.name')
                                PsiElement())(')')
                          PsiElement())(')')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Freq')
                          PsiElement(>)('>')
                          R_EXPR
                            PsiElement(NUM_CONST)('2')
                    PsiElement())(')')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('Var1')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('supfamsOfInterest')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('union')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('shared_terms')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('top10')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('Short.name')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('## Visualize the bcknd-frequency distribution')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prionBckndASDist')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('amacid_bcknd')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('frequency_bcknd')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fill')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('species_bcknd')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('position')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"dodge"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"Background AS frequencies per species"')
                PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"as freq bias - Background AS frequencies per species.png"')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## just keep the domain with superfamilies of interest in the same protein')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('domains_all_sf')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.table')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('file')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"cdd_superfamily_domains_all_species.csv"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('header')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
      PsiComment(COMMENT)('# ## Options 1: keep all the terms for ALL species')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# domains_of_interest <- subset(domains_all_sf, Short.name %in% supfamsOfInterest)')
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# domains_of_interest <- subset(domains_all_sf, Short.name %in% shared_terms)')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('## Options 2: keep only the top 10 terms for all species')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('domains_of_interest')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_all_sf')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('top10')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"Short.name"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('# export this superfamilies of interest to allow an import into Geneious')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('write.tsv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('domains_of_interest')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('file')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"domains_of_interest.csv"')
            PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ddply')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('subset')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('domains_of_interest')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(!)('!')
                        R_EXPR
                          PsiElement(SYMBOL)('str_detect')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('species')
                            PsiElement(,)(',')
                            R_SUB
                              R_EXPR
                                PsiElement(STR_CONST)('"cervi"')
                          PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('.')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('Short.name')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('nrow')
            PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## combine superfamily domains and domains')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('pDomsWithSupDoms')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('domains_of_interest')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prots_with_pdomsegs')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"gene_id"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('# pDomsWithSupDoms4Pyhlogeney <- pDomsWithSupDoms')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('pDomsWithSupDoms')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('pDomsWithSupDoms')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('select')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(-)('-')
                    R_EXPR
                      PsiElement(SYMBOL)('c')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('Segmentation')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('Sequence')
                      PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n\n')
    PsiComment(COMMENT)('## calculate the AS freq-dists per superfamily and species ')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('asFreqDists')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('pDomsWithSupDoms')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    R_FUNDEF
                      PsiElement(FUNCTION)('function')
                      PsiElement(()('(')
                      R_FORMLIST
                        R_FORM
                          PsiElement(SYMBOL)('x')
                      PsiElement())(')')
                      R_EXPR_OR_ASSIGN
                        R_EXPR
                          PsiElement(SYMBOL)('calcASFreqDist')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('x')
                                PsiElement($)('$')
                                PsiElement(SYMBOL)('domain_seq')
                          PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.progress')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"text"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## normalize them against the bcknd-AS-freq dist per species')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('asFreqDists')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('asFreqDists')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('prionBckndASDist')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"amacid"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.y')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"species_bcknd"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"amacid_bcknd"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('asFreqDists')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('asFreqDists')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('norm_frequency')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('frequency')
                    PsiElement(/)('/')
                    R_EXPR
                      PsiElement(SYMBOL)('frequency_bcknd')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      PsiComment(COMMENT)('## start of categorization of AS into groups')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('asCategoryMapping')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('list')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(EOL)('\n')
                  PsiElement(SYMBOL)('positive_charged')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"R"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"H"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"K"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(EOL)('\n')
                  PsiElement(SYMBOL)('negative_charged')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"D"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"E"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(EOL)('\n')
                  PsiElement(SYMBOL)('Serine')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"S"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Threonine')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"T"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Asparagine')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"N"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Gluatime')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"Q"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(EOL)('\n')
                  PsiElement(SYMBOL)('Cysteine')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"C"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Selenocysteine')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"U"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Glycine')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"G"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('Proline')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"P"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(EOL)('\n')
                  PsiElement(SYMBOL)('hydrophobic')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"A"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"V"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"I"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"L"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"M"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"F"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"Y"')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"W"')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('asCategories')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('transform')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ldply')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('asCategoryMapping')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          R_FUNDEF
                            PsiElement(FUNCTION)('function')
                            PsiElement(()('(')
                            R_FORMLIST
                              R_FORM
                                PsiElement(SYMBOL)('x')
                            PsiElement())(')')
                            R_EXPR_OR_ASSIGN
                              R_EXPR
                                PsiElement(SYMBOL)('data.frame')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    PsiElement(SYMBOL)('amacid')
                                    PsiElement(=)('=')
                                    R_EXPR
                                      PsiElement(SYMBOL)('x')
                                PsiElement())(')')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('as_type')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('.id')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('.id')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(NULL_CONST)('NULL')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('asFreqDists')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('asFreqDists')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('asCategories')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"amacid"')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('asFreqDists')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('ddply')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('asFreqDists')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('.')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('as_type')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('transform')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('norm_frequency')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('mean')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('norm_frequency')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('amacid')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('as_type')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      PsiComment(COMMENT)('## end of categorization')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n\n')
          R_EXPR
            PsiElement(SYMBOL)('ggplot')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('asFreqDists')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('aes')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('amacid')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('log2')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('norm_frequency')
                        PsiElement())(')')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('fill')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                  PsiElement())(')')
            PsiElement())(')')
            PsiElement(+)('+')
            R_EXPR
              PsiElement(SYMBOL)('geom_bar')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  PsiElement(SYMBOL)('stat')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"identity"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('position')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"dodge"')
              PsiElement())(')')
              PsiElement(+)('+')
              R_EXPR
                PsiElement(SYMBOL)('opts')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    PsiElement(SYMBOL)('title')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"AS frequency bias"')
                PsiElement())(')')
                PsiElement(+)('+')
                R_EXPR
                  PsiElement(SYMBOL)('facet_wrap')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(~)('~')
                        R_EXPR
                          PsiElement(SYMBOL)('Short.name')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('ncol')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(NUM_CONST)('3')
                  PsiElement())(')')
                  PsiElement(+)('+')
                  R_EXPR
                    PsiElement(SYMBOL)('opts')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        PsiElement(SYMBOL)('axis.text.x')
                        PsiElement(=)('=')
                        R_EXPR
                          PsiElement(SYMBOL)('theme_text')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              PsiElement(SYMBOL)('angle')
                              PsiElement(=)('=')
                              R_EXPR
                                PsiElement(NUM_CONST)('90')
                          PsiElement())(')')
                    PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ggsave')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"as freq bias.png"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('width')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(NUM_CONST)('10')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('height')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(NUM_CONST)('9')
            PsiElement())(')')
        PsiElement(EOL)('\n\n\n\n\n')
      PsiComment(COMMENT)('##################################################################################################')
      R_PROG
        R_EXPR_OR_ASSIGN
          PsiElement(EOL)('\n')
          PsiComment(COMMENT)('# prepare the list of protein for which we want to align the pictorgrams')
          PsiElement(EOL)('\n\n')
          PsiComment(COMMENT)('# protsOfInterest <- subset(pDomsWithSupDoms, Short.name %in% c("PKc_like", "RRM") & !str_detect(species, "cerivisae"))')
          PsiElement(EOL)('\n')
          R_EXPR
            PsiElement(SYMBOL)('protsOfInterest')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('pDomsWithSupDoms')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(!)('!')
                    R_EXPR
                      PsiElement(SYMBOL)('str_detect')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('species')
                        PsiElement(,)(',')
                        R_SUB
                          R_EXPR
                            PsiElement(STR_CONST)('"cerivisae"')
                      PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
    PsiElement(DUMMY_BLOCK)
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('protsOfInterest')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protsOfInterest')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('select')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('c')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('gene_id')
                    PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('protsOfInterest')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('protsOfInterest')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(!)('!')
                    R_EXPR
                      PsiElement(SYMBOL)('duplicated')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('gene_id')
                      PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dicty_orthologues')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('read.csv')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(STR_CONST)('"../Dicty/dicty_orthologues.csv"')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('ddisc_mapped')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('subset')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('protsOfInterest')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                          PsiElement(==)('==')
                          R_EXPR
                            PsiElement(STR_CONST)('"d. discoideum"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dicty_orthologues')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"gene_id"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.y')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"ddisc_gene_id"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('all.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dpurp_mapped')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('merge')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('subset')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('protsOfInterest')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('species')
                          PsiElement(==)('==')
                          R_EXPR
                            PsiElement(STR_CONST)('"d. purpureum"')
                    PsiElement())(')')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dicty_orthologues')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"gene_id"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('by.y')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(STR_CONST)('"dpurp_gene_id"')
                PsiElement(,)(',')
                R_SUB
                  PsiElement(SYMBOL)('all.x')
                  PsiElement(=)('=')
                  R_EXPR
                    PsiElement(SYMBOL)('TRUE')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('dpurp_mapped')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('dpurp_mapped')
              PsiElement([)('[')
              PsiElement(,)(',')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ncol')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('dpurp_mapped')
                    PsiElement())(')')
                    PsiElement(:)(':')
                    R_EXPR
                      PsiElement(NUM_CONST)('1')
              PsiElement(])(']')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('names')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('dpurp_mapped')
            PsiElement())(')')
            PsiElement([)('[')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(NUM_CONST)('3')
            PsiElement(])(']')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(STR_CONST)('"dpurp_gene_id"')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('names')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('ddisc_mapped')
            PsiElement())(')')
            PsiElement([)('[')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(NUM_CONST)('1')
            PsiElement(])(']')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(STR_CONST)('"ddisc_gene_id"')
        PsiElement(EOL)('\n\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('orthologuesEnrSF')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('rbind')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('dpurp_mapped')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('ddisc_mapped')
              PsiElement())(')')
        PsiElement(EOL)('\n')
      R_PROG
        R_EXPR_OR_ASSIGN
          R_EXPR
            PsiElement(SYMBOL)('orthologuesEnrSF')
            PsiElement(<-)('<-')
            R_EXPR
              PsiElement(SYMBOL)('subset')
              PsiElement(()('(')
              R_SUBLIST
                R_SUB
                  R_EXPR
                    PsiElement(SYMBOL)('orthologuesEnrSF')
                PsiElement(,)(',')
                R_SUB
                  R_EXPR
                    PsiElement(!)('!')
                    R_EXPR
                      PsiElement(SYMBOL)('duplicated')
                      PsiElement(()('(')
                      R_SUBLIST
                        R_SUB
                          R_EXPR
                            PsiElement(SYMBOL)('paste')
                            PsiElement(()('(')
                            R_SUBLIST
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('ddisc_gene_id')
                              PsiElement(,)(',')
                              R_SUB
                                R_EXPR
                                  PsiElement(SYMBOL)('dpurp_gene_id')
                            PsiElement())(')')
                      PsiElement())(')')
              PsiElement())(')')
        PsiElement(EOL)('\n\n')
  PsiComment(COMMENT)('## todo put into slide')
  PsiElement(DUMMY_BLOCK)
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n')
        R_EXPR
          PsiElement(SYMBOL)('table')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('complete.cases')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('orthologuesEnrSF')
                PsiElement())(')')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('orthologuesEnrSF')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('orthologuesEnrSF')
            PsiElement([)('[')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('complete.cases')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('orthologuesEnrSF')
                  PsiElement())(')')
            PsiElement(,)(',')
            PsiElement(])(']')
      PsiElement(EOL)('\n')
    PsiComment(COMMENT)('# export the sequences of both sets into a fasta file')
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n')
        R_EXPR
          PsiElement(SYMBOL)('print')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('load')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(STR_CONST)('".all_species_paths.RData"')
                PsiElement())(')')
          PsiElement())(')')
      PsiElement(EOL)('\n\n\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('with')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('subset')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('all_species_paths')
                  PsiElement(,)(',')
                  R_SUB
                    R_EXPR
                      PsiElement(!)('!')
                      R_EXPR
                        PsiElement(SYMBOL)('duplicated')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('GeneDesc')
                        PsiElement())(')')
                        PsiElement(&)('&')
                        R_EXPR
                          PsiElement(()('(')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement(SYMBOL)('GeneDesc')
                              PsiElement(ARITH_MISC)('%in%')
                              R_EXPR
                                PsiElement(SYMBOL)('as.character')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('orthologuesEnrSF')
                                      PsiElement($)('$')
                                      PsiElement(SYMBOL)('ddisc_gene_id')
                                PsiElement())(')')
                          PsiElement())(')')
                PsiElement())(')')
            PsiElement(,)(',')
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('write.fasta')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(,)(',')
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('Sequence')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('file')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"domain_orths_ddisc.fasta"')
                PsiElement())(')')
          PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('with')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('subset')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('all_species_paths')
                  PsiElement(,)(',')
                  R_SUB
                    R_EXPR
                      PsiElement(!)('!')
                      R_EXPR
                        PsiElement(SYMBOL)('duplicated')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('GeneDesc')
                        PsiElement())(')')
                        PsiElement(&)('&')
                        R_EXPR
                          PsiElement(()('(')
                          R_EXPR_OR_ASSIGN
                            R_EXPR
                              PsiElement(SYMBOL)('GeneDesc')
                              PsiElement(ARITH_MISC)('%in%')
                              R_EXPR
                                PsiElement(SYMBOL)('as.character')
                                PsiElement(()('(')
                                R_SUBLIST
                                  R_SUB
                                    R_EXPR
                                      PsiElement(SYMBOL)('orthologuesEnrSF')
                                      PsiElement($)('$')
                                      PsiElement(SYMBOL)('dpurp_gene_id')
                                PsiElement())(')')
                          PsiElement())(')')
                PsiElement())(')')
            PsiElement(,)(',')
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('write.fasta')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(,)(',')
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('Sequence')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('file')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(STR_CONST)('"domain_orths_dpurp.fasta"')
                PsiElement())(')')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
    PsiComment(COMMENT)('## without the duplicate removal hack# ')
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n')
        PsiComment(COMMENT)('# with(subset(all_species_paths, GeneDesc %in% as.character(orthologuesEnrSF$ddisc_gene_id)), write.fasta(GeneDesc, Sequence, file="domain_orths_ddisc.fasta"))')
        PsiElement(EOL)('\n')
        PsiComment(COMMENT)('# with(subset(all_species_paths, GeneDesc %in% as.character(orthologuesEnrSF$dpurp_gene_id)), write.fasta(GeneDesc, Sequence, file="domain_orths_dpurp.fasta"))')
        PsiElement(EOL)('\n\n\n')
        R_EXPR
          PsiElement(SYMBOL)('write.tsv')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('transform')
                PsiElement(()('(')
                R_SUBLIST
                  R_SUB
                    R_EXPR
                      PsiElement(SYMBOL)('orthologuesEnrSF')
                  PsiElement(,)(',')
                  R_SUB
                    PsiElement(SYMBOL)('orth_index')
                    PsiElement(=)('=')
                    R_EXPR
                      PsiElement(NUM_CONST)('1')
                      PsiElement(:)(':')
                      R_EXPR
                        PsiElement(SYMBOL)('nrow')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            R_EXPR
                              PsiElement(SYMBOL)('orthologuesEnrSF')
                        PsiElement())(')')
                PsiElement())(')')
            PsiElement(,)(',')
            R_SUB
              PsiElement(SYMBOL)('file')
              PsiElement(=)('=')
              R_EXPR
                PsiElement(STR_CONST)('"domain_structure_orth_mapping.csv"')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('subset')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('orthologuesEnrSF')
            PsiElement(,)(',')
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('dpurp_gene_id')
                PsiElement(==)('==')
                R_EXPR
                  PsiElement(STR_CONST)('"DPU_G0074906"')
          PsiElement())(')')
      PsiElement(EOL)('\n\n\n\n\n')
    PsiComment(COMMENT)('#####################################################################')
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n')
        PsiComment(COMMENT)('### Orthologue analysis')
        PsiElement(EOL)('\n')
        PsiComment(COMMENT)('#####################################################################')
        PsiElement(EOL)('\n\n')
        R_EXPR
          PsiElement(SYMBOL)('setwd')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('baseDirectory')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('jgi2dpu_mapping')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('read.table')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"Dicty/purpureum/GeneID-JGI.txt"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('header')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('TRUE')
            PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('orthologues')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('read.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"Dicty/purpureum/orthologues_with_ddict.csv"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('header')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('TRUE')
            PsiElement())(')')
      PsiElement(EOL)('\n')
  PsiElement(DUMMY_BLOCK)
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('names')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('orthologues')
          PsiElement())(')')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('c')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"source"')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"JGI"')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"dictybase_id"')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"gene_name"')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"description"')
            PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('orthologues_mapping')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('merge')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('orthologues')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('jgi2dpu_mapping')
            PsiElement())(')')
      PsiElement(EOL)('\n\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('slim_ortho_mapping')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('orthologues_mapping')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('select')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('GeneID')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('dictybase_id')
                  PsiElement())(')')
            PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('slim_ortho_mapping')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('rename')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('slim_ortho_mapping')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      PsiElement(SYMBOL)('GeneID')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('"dpurp_gene_id"')
                    PsiElement(,)(',')
                    R_SUB
                      PsiElement(SYMBOL)('dictybase_id')
                      PsiElement(=)('=')
                      R_EXPR
                        PsiElement(STR_CONST)('"ddisc_gene_id"')
                  PsiElement())(')')
            PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('write.csv')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('slim_ortho_mapping')
            PsiElement(,)(',')
            R_SUB
              R_EXPR
                PsiElement(STR_CONST)('"Dicty/dicty_orthologues.csv"')
            PsiElement(,)(',')
            R_SUB
              PsiElement(SYMBOL)('row.names')
              PsiElement(=)('=')
              R_EXPR
                PsiElement(SYMBOL)('FALSE')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('read.csv')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(STR_CONST)('"results/all_species_proteins_with_pdomain.csv"')
            PsiElement())(')')
      PsiElement(EOL)('\n\n')
    PsiComment(COMMENT)('## add the orthologue info')
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n')
        R_EXPR
          PsiElement(SYMBOL)('prots_with_pdom_purp')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('str_detect')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"purp"')
                  PsiElement())(')')
            PsiElement())(')')
      PsiElement(;)(';')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('nrow')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('prots_with_pdom_purp')
          PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('prots_with_pdom_purp')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('merge')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdom_purp')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('slim_ortho_mapping')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('by.x')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"GeneDesc"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('by.y')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"dpurp_gene_id"')
            PsiElement())(')')
      PsiElement(;)(';')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('nrow')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('prots_with_pdom_purp')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
  PsiComment(COMMENT)('# constrain ddict also to just those genes for which there are orthologues')
  PsiElement(DUMMY_BLOCK)
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n')
        R_EXPR
          PsiElement(SYMBOL)('prots_with_pdom_ddisc')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('all_species_proteins_with_pdomain')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('str_detect')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('species')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"disc"')
                  PsiElement())(')')
            PsiElement())(')')
      PsiElement(;)(';')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('nrow')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('prots_with_pdom_ddisc')
          PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('prots_with_pdom_ddisc')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdom_ddisc')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('GeneDesc')
                  PsiElement(ARITH_MISC)('%in%')
                  R_EXPR
                    PsiElement(SYMBOL)('slim_ortho_mapping')
                    PsiElement($)('$')
                    PsiElement(SYMBOL)('ddisc_gene_id')
            PsiElement())(')')
      PsiElement(;)(';')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('nrow')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('prots_with_pdom_ddisc')
          PsiElement())(')')
      PsiElement(EOL)('\n\n')
    PsiComment(COMMENT)('# ddply(prots_with_pdom_ddisc, .(GeneDesc), subset, length(GeneDesc)>1)')
    R_PROG
      R_EXPR_OR_ASSIGN
        PsiElement(EOL)('\n\n')
        PsiComment(COMMENT)('## is there any overlap between discoideum and purpureum?')
        PsiElement(EOL)('\n')
        R_EXPR
          PsiElement(SYMBOL)('gene_with_poverlap')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('list')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                PsiElement(SYMBOL)('ddisc')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdom_ddisc')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('GeneDesc')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('dpurp')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdom_purp')
                  PsiElement($)('$')
                  PsiElement(SYMBOL)('dictybase_id')
            PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('vPlot')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('venn.diagram')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                PsiElement(SYMBOL)('x')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('gene_with_poverlap')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('filename')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(NULL_CONST)('NULL')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('fill')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"cornflowerblue"')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"darkorchid1"')
                  PsiElement())(')')
            PsiElement())(')')
      PsiComment(COMMENT)('#')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('grid.newpage')
          PsiElement(()('(')
          R_SUBLIST
            <empty list>
          PsiElement())(')')
      PsiElement(;)(';')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('grid.draw')
          PsiElement(()('(')
          R_SUBLIST
            R_SUB
              R_EXPR
                PsiElement(SYMBOL)('vPlot')
          PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('protein_overlap')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('merge')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('prots_with_pdom_ddisc')
              PsiElement(,)(',')
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('rename')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('prots_with_pdom_purp')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(SYMBOL)('c')
                        PsiElement(()('(')
                        R_SUBLIST
                          R_SUB
                            PsiElement(SYMBOL)('GeneDesc')
                            PsiElement(=)('=')
                            R_EXPR
                              PsiElement(STR_CONST)('"GeneDesc_dpurp"')
                        PsiElement())(')')
                  PsiElement())(')')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('by.x')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"GeneDesc"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('by.y')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(STR_CONST)('"dictybase_id"')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('suffixes')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(SYMBOL)('c')
                  PsiElement(()('(')
                  R_SUBLIST
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"_ddisc"')
                    PsiElement(,)(',')
                    R_SUB
                      R_EXPR
                        PsiElement(STR_CONST)('"_dpurp"')
                  PsiElement())(')')
            PsiElement())(')')
      PsiElement(EOL)('\n')
    R_PROG
      R_EXPR_OR_ASSIGN
        R_EXPR
          PsiElement(SYMBOL)('protein_overlap_noseqs')
          PsiElement(<-)('<-')
          R_EXPR
            PsiElement(SYMBOL)('subset')
            PsiElement(()('(')
            R_SUBLIST
              R_SUB
                R_EXPR
                  PsiElement(SYMBOL)('protein_overlap')
              PsiElement(,)(',')
              R_SUB
                PsiElement(SYMBOL)('select')
                PsiElement(=)('=')
                R_EXPR
                  PsiElement(!)('!')
                  R_EXPR
                    PsiElement(SYMBOL)('str_detect')
                    PsiElement(()('(')
                    R_SUBLIST
                      R_SUB
                        R_EXPR
                          PsiElement(SYMBOL)('colnames')
                          PsiElement(()('(')
                          R_SUBLIST
                            R_SUB
                              R_EXPR
                                PsiElement(SYMBOL)('protein_overlap')
                          PsiElement())(')')
                      PsiElement(,)(',')
                      R_SUB
                        R_EXPR
                          PsiElement(STR_CONST)('"Segmentation|Sequence|species"')
                    PsiElement())(')')
            PsiElement())(')')
      PsiElement(EOL)('\n')
  R_PROG
    R_EXPR_OR_ASSIGN
      R_EXPR
        PsiElement(SYMBOL)('write.csv')
        PsiElement(()('(')
        R_SUBLIST
          R_SUB
            R_EXPR
              PsiElement(SYMBOL)('protein_overlap_noseqs')
          PsiElement(,)(',')
          R_SUB
            PsiElement(SYMBOL)('file')
            PsiElement(=)('=')
            R_EXPR
              PsiElement(STR_CONST)('"results/disc_dpurp_ortho_overlap.csv"')
          PsiElement(,)(',')
          R_SUB
            PsiElement(SYMBOL)('row.names')
            PsiElement(=)('=')
            R_EXPR
              PsiElement(SYMBOL)('FALSE')
        PsiElement())(')')
    PsiElement(EOL)('\n\n')
  PsiComment(COMMENT)('# protein_overlap[3,]')
  R_PROG
    PsiElement(EOL)('\n')
  PsiComment(COMMENT)('# subset(extractDomainSegs(prots_with_pdom_ddisc), gene_id=="DDB_G0267422")')
  R_PROG
    PsiElement(EOL)('\n')
  PsiComment(COMMENT)('# subset(extractDomainSegs(prots_with_pdom_purp), dictybase_id=="DDB_G0267422")')
  R_PROG
    PsiElement(EOL)('\n\n\n')